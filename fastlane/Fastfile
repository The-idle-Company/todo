default_platform(:ios)

platform :ios do
  desc "Upload IPA to TestFlight"
  lane :upload_ipa_to_testflight do
    # Load the API Key from the environment variable
    ENV['FASTLANE_APP_STORE_CONNECT_API_KEY'] = ENV['APP_STORE_CONNECT_API_KEY_JSON']

    # Use pilot to upload the IPA to TestFlight
    pilot(
      ipa: "#{ENV['RUNNER_TEMP']}/ToDo.ipa",  # Ensure the path is correctly concatenated
      app_identifier: "com.test.todo.kehinde" # Ensure this matches exactly
    )
  end
end
